{% extends 'base.html.twig' %}

{% block title %}Gestion des Livres{% endblock %}

{% block body %}
{{ include('components/page_header.html.twig', {
    'title': 'Gestion des Livres',
    'breadcrumb': [
        {'label': 'Livres'}
    ],
    'actions': [
        {
            'url': path('app_livre_new'),
            'class': 'btn-gradient',
            'icon': 'bi-plus-circle',
            'label': 'Nouveau Livre'
        }
    ]
}) }}

<!-- Stats Overview -->
<div class="stats-grid mb-4">
    {{ include('components/stat_card.html.twig', {
        'value': livres|length,
        'label': 'Total Livres',
        'icon': 'bi-book',
        'icon_color': '#667eea'
    }) }}
</div>

<!-- Books Table -->
<div class="card-modern">
    {{ include('components/card_header.html.twig', {
        'icon': 'bi-list',
        'title': 'Liste des Livres',
        'actions': [
            {'type': 'button', 'icon': 'bi-funnel', 'title': 'Filtrer'},
            {'type': 'button', 'icon': 'bi-download', 'title': 'Exporter'}
        ]
    }) }}
    <div class="card-body-modern">
        {% if livres|length > 0 %}
            <div class="table-responsive">
                <table class="table-modern">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>LIVRE</th>
                            <th>QUANTITÉ</th>
                            <th>PRIX UNITAIRE</th>
                            <th>ISBN</th>
                            <th>DATE PUBLICATION</th>
                            <th>EDITEUR</th>
                            <th>CATEGORIE</th>
                            <th>ACTIONS</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for livre in livres %}
                            <tr>
                                <td>
                                    <code style="background: #f7f9fc; padding: 4px 4px; border-radius: 6px; font-size: 0.85rem; color: #667eea;">
                                        #{{ livre.id }}
                                    </code>
                                </td>
                                <td>
                                    <div style="display: flex; align-items: center; gap: 12px;">
                                        <div style="width: 45px; height: 45px; background: linear-gradient(135deg, #667eea, #764ba2); border-radius: 12px; display: flex; align-items: center; justify-content: center; color: white; font-size: 1.2rem;">
                                            <i class="bi bi-book"></i>
                                        </div>
                                        <div>
                                            <div style="font-weight: 600; color: #1a1d2e;">{{ livre.titre }}</div>
                                            <div style="font-size: 0.85rem; color: #8f9bb3;">Livre de la bibliothèque</div>
                                        </div>
                                    </div>
                                </td>
                                <td>
                                    <span class="badge-modern" style="background: {{ livre.qte > 10 ? 'rgba(79, 172, 254, 0.1)' : 'rgba(245, 87, 108, 0.1)' }}; color: {{ livre.qte > 10 ? '#4facfe' : '#f5576c' }};">
                                        {{ livre.qte }} unité{{ livre.qte > 1 ? 's' : '' }}
                                    </span>
                                </td>
                                <td>
                                    <strong style="color: #667eea; font-size: 1.05rem;">
                                        {{ livre.pu|number_format(2, ',', ' ') }} €
                                    </strong>
                                </td>
                                <td>
                                    <code style="background: #f7f9fc; padding: 4px 10px; border-radius: 6px; font-size: 0.85rem; color: #667eea;">
                                        {{ livre.isbn }}
                                    </code>
                                </td>
                                <td style="color: #8f9bb3;">
                                    {{ livre.datpub ? livre.datpub|date('d/m/Y') : 'N/A' }}
                                </td>
                                <td>
                                    {{ livre.editeur ? livre.editeur.nom : '—' }}
                                </td>
                                <td>
                                    {{ livre.categorie ? livre.categorie.destignation : '—' }}
                                </td>
                                <td>
                                    {{ include('components/action_buttons.html.twig', {
                                        'actions': [
                                            {
                                                'url': path('app_livre_show', {'id': livre.id}),
                                                'icon': 'bi-eye',
                                                'title': 'Voir les détails'
                                            },
                                            {
                                                'url': path('app_livre_edit', {'id': livre.id}),
                                                'icon': 'bi-pencil',
                                                'title': 'Modifier'
                                            }
                                        ]
                                    }) }}
                                </td>
                            </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        {% else %}
            {{ include('components/empty_state.html.twig', {
                'icon': 'bi-book',
                'icon_color': '#667eea',
                'title': 'Aucun livre trouvé',
                'message': 'Commencez par ajouter votre premier livre à la bibliothèque',
                'action_url': path('app_livre_new'),
                'action_icon': 'bi-plus-circle',
                'action_text': 'Ajouter un livre'
            }) }}
        {% endif %}
    </div>
</div>
{% endblock %}
